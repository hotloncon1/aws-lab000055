<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.101.0"><meta name=description content><meta name=author content="journeyoftheaverageguy@gmail.com"><link rel=icon href=https://hotloncon1.github.io/aws-lab000055/images/favicon.png type=image/png><title>Build A Client To Consume The API :: Creating an Authenticated Single Page Application (SPA)</title><link href=https://hotloncon1.github.io/aws-lab000055/css/nucleus.css?1659035587 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/fontawesome-all.min.css?1659035587 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/hybrid.css?1659035587 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/featherlight.min.css?1659035587 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/perfect-scrollbar.min.css?1659035587 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/auto-complete.css?1659035587 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/atom-one-dark-reasonable.css?1659035587 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/theme.css?1659035587 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/hugo-theme.css?1659035587 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/theme-workshop.css?1659035587 rel=stylesheet><script src=https://hotloncon1.github.io/aws-lab000055/js/jquery-3.3.1.min.js?1659035587></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.6-build-api-consumer/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://hotloncon1.github.io/aws-lab000055/><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=https://hotloncon1.github.io/aws-lab000055/js/lunr.min.js?1659035587></script>
<script type=text/javascript src=https://hotloncon1.github.io/aws-lab000055/js/auto-complete.js?1659035587></script>
<script type=text/javascript>var baseurl="https://hotloncon1.github.io/aws-lab000055/"</script><script type=text/javascript src=https://hotloncon1.github.io/aws-lab000055/js/search.js?1659035587></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-introduction/ title=Introduction class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/1-introduction/><b>1. </b>Introduction
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2-prepare/ title=Preparation class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/2-prepare/><b>2. </b>Preparation
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/2-prepare/2.1-createkeypair/ title="Create Key Pair" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/2-prepare/2.1-createkeypair/><b>2.1. </b>Create Key Pair
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2-prepare/2.2-createstack/ title="Create a CloudFormation stack" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/2-prepare/2.2-createstack/><b>2.2. </b>Create a CloudFormation stack
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2-prepare/2.3-connectvirtualmachine/ title="Connect to the Windows Instance" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/2-prepare/2.3-connectvirtualmachine/><b>2.3. </b>Connect to the Windows Instance
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/3-create-single-page-app/ title="Creating A Single Page Application" class="dd-item
parent"><a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/><b>3. </b>Creating A Single Page Application
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-create-single-page-app/3.1-create-dynamodb-table/ title="Create A DynamoDB Table" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.1-create-dynamodb-table/><b>3.1. </b>Create A DynamoDB Table
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-create-single-page-app/3.2-build-and-deploy-serverless-microservice/ title="Manually Build And Deploy A Serverless Microservice" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.2-build-and-deploy-serverless-microservice/><b>3.2. </b>Manually Build And Deploy A Serverless Microservice
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-create-single-page-app/3.3-create-api-with-api-gateway/ title="Create And Expose the API with Amazon API Gateway" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.3-create-api-with-api-gateway/><b>3.3. </b>Create And Expose the API with Amazon API Gateway
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-create-single-page-app/3.4-deploy-api-with-codestar/ title="Deploy the api using code star and CI/CD" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.4-deploy-api-with-codestar/><b>3.4. </b>Deploy the api using code star and CI/CD
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-create-single-page-app/3.5-setup-single-page-app-website/ title="Setup The Single Page Application Website" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.5-setup-single-page-app-website/><b>3.5. </b>Setup The Single Page Application Website
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-create-single-page-app/3.6-build-api-consumer/ title="Build A Client To Consume The API" class="dd-item
active"><a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.6-build-api-consumer/><b>3.6. </b>Build A Client To Consume The API
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-configure-aaa/ title="Configure Authentication, Authorization and Accounting (AAA)" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/4-configure-aaa/><b>4. </b>Configure Authentication, Authorization and Accounting (AAA)
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/4-configure-aaa/4.1-add-authentication-with-cognito/ title="Add Authentication to the SPA using Amazon Cognito User Pools" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/4-configure-aaa/4.1-add-authentication-with-cognito/><b>4.1. </b>Add Authentication to the SPA using Amazon Cognito User Pools
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-configure-aaa/4.2-setup-authentication/ title="Microservice Authentication" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/4-configure-aaa/4.2-setup-authentication/><b>4.2. </b>Microservice Authentication
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-configure-aaa/4.3-deploy-and-test/ title="Deploy And Test" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/4-configure-aaa/4.3-deploy-and-test/><b>4.3. </b>Deploy And Test
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-configure-aaa/4.4-add-new-user-signup_signin/ title="Add New User Sign Up and Sign In" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/4-configure-aaa/4.4-add-new-user-signup_signin/><b>4.4. </b>Add New User Sign Up and Sign In
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-tracing-application-performance-with-xray/ title="Tracing Application Performance With AWS X-Ray" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/5-tracing-application-performance-with-xray/><b>5. </b>Tracing Application Performance With AWS X-Ray
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/6-challenge/ title=Challenge class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/6-challenge/><b>6. </b>Challenge
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-cleanup/ title="Clean up resources" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/7-cleanup/><b>7. </b>Clean up resources
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/660548818043427/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.6-build-api-consumer/ selected>English</option><option id=vi value=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.6-build-api-consumer/>Tiếng Việt</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7833031&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0></left>
<left><br><br><b>Last Updated</b><br><i><font color=orange>29-07-2022</font></i></left>
<left><br><br><b>Team</b><br><i><a href=https://www.linkedin.com/in/jotaguy style=color:orange>Gia Hưng</a></i></left>
<script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=https://hotloncon1.github.io/aws-lab000055/>Refactor Your Data & Workflows</a> > <a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/>Creating A Single Page Application</a> > Build A Client To Consume The API</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Build A Client To Consume The API</h1><h4 id=build-a-client-to-consume-the-api>Build A Client To Consume The API</h4><p>You now have a working model of the web site running as an SPA calling for data via RESTful APIs hosted on AWS Lambda, and served from Amazon API Gateway. These data feeds are considered public because the user does not need to be signed-in and provide credentials for the call to the API. In this exercise, we will take a look at how we can require authentication to make the API calls, and the use of API Keys to enforce call-rate throttling and quota management. To demonstrate, we will use a Java client application, to show how you can consume the auto-generated Java SDKs in your applications.</p><h4 id=create-response-model-for-the-tripsearch-api>Create Response Model for the TripSearch API</h4><p>In order for the SDK generator to create the appropriate classes for a strongly-typed language like Java (as opposed to Javascript, for example) we need to tell API Gateway what the shape or schema of the request/response objects looks like. In the TripSearch API, we are using the <strong>GET</strong> method for each of the three API calls. Therefore, there is no schema for inbound requests because the city parameter is passed on as part of the URL. If we instead changed the method to <strong>POST</strong>, we would need to pass in the city parameter in the <strong>body</strong> payload, and would need to create a model for this object schema for the code generator to create a Java class for us to bind to.</p><p>The result data from the API calls is returned in the body of the response. In order for the code generator to create an appropriate class to represent this response, we need to create a response model, and set it as the method response model.</p><ol><li>Go to <a href=https://console.aws.amazon.com/apigateway/home><strong>AWS API Gateway console</strong></a></li></ol><ul><li>Type <strong>iDevelop - Trip Search API</strong> to the search bar and press <strong>Enter</strong></li><li>Click <strong>iDevelop - Trip Search API</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-001.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=2><li>Click <strong>Models</strong></li></ol><ul><li>Click <strong>Create</strong></li><li>In the <strong>Model name</strong> section, type <code>TripsFromCityResponse</code></li><li>In the <strong>Content-type</strong> section, type <code>application/json</code></li><li>In the <strong>Model schema</strong> section, type</li></ul><pre tabindex=0><code>{
  &#34;type&#34;: &#34;object&#34;,
  &#34;properties&#34;: {
    &#34;succeeded&#34;: {
      &#34;type&#34;: &#34;boolean&#34;
    },
    &#34;errorMessage&#34;: {
      &#34;type&#34;: &#34;string&#34;
    },
    &#34;errorType&#34;: {
      &#34;type&#34;: &#34;number&#34;
    },
    &#34;data&#34;: {
      &#34;type&#34;: &#34;array&#34;,
      &#34;items&#34;: {
        &#34;type&#34;: &#34;object&#34;,
        &#34;properties&#34;: {
          &#34;date&#34;: {
            &#34;type&#34;: &#34;number&#34;
          },
          &#34;originCity&#34;: {
            &#34;type&#34;: &#34;string&#34;
          },
          &#34;destinationCity&#34;: {
            &#34;type&#34;: &#34;string&#34;
          },
          &#34;airline&#34;: {
            &#34;type&#34;: &#34;string&#34;
          }
        }
      }
    }
  },
  &#34;title&#34;: &#34;TripsFromCityResponse&#34;
}
</code></pre><ul><li>Click <strong>Create model</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-002.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><h4 id=assign-the-tripsfromcityresponse-model-to-the-tripsfromcity-api-call>Assign the TripsFromCityResponse model to the <strong>/tripsfromcity</strong> API call</h4><ol start=3><li>Click <strong>Resources</strong></li></ol><ul><li>Click the <strong>GET</strong> method beneath <strong>/tripsfromcity/{city}</strong></li><li>Click <strong>Method Response</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-003.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=4><li>In the <strong>/tripsfromcity/{city} - GET - Method Response</strong> panel, click the arrow next to <strong>HTTP Status</strong> to reveal the panel</li></ol><ul><li>Under <strong>Response Body for 200</strong> click the <strong>pencil icon</strong> next to the <strong>Empty model</strong>.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-004.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=5><li>The field becomes a drop-down list. Select <strong>TripsFromCityResponse</strong></li></ol><ul><li>Click the grey tick to commit the change
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-005.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=6><li>Click <strong>Actions</strong></li></ol><ul><li>Click <strong>Deploy API</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-006.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=7><li>In the <strong>Deployment stage</strong> section, select <strong>prod</strong></li></ol><ul><li>Click <strong>Deploy</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-007.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=8><li>On the <strong>prod Stage Editor</strong> that appears, click <strong>SDK Generation</strong></li></ol><ul><li>In the <strong>Platform</strong> section, select <strong>Java SDK</strong></li><li>In the <strong>Service name</strong> section, type <code>TripSearch</code></li><li>In the <strong>Java package name</strong> section, type <code>idevelop.api.sdk</code></li><li>Click <strong>Generate SDK</strong>. The Java SDK will be generated and downloaded as a ZIP file.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-008.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=9><li>Extract the downloaded ZIP file we downloaded in step 8</li></ol><ul><li>Open <strong>Command Prompt</strong> and navigate to the directory of the downloaded SDK has been exploded (the directory is called <strong>generated-code</strong>)</li><li>Execute the following command</li></ul><pre tabindex=0><code>mvn install
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-009.png?featherlight=false&width=60pc" alt="Build A Client To Consume The API">
This will compile and install the SDK in your local Maven repository and we will refer to it in the next steps.</p><h4 id=build-a-java-client-application-that-consumes-the-api>Build a Java client application that consumes the API</h4><section class="attachments orange"><label><i class="fas fa-paperclip" aria-hidden=true></i>
TripSearchJavaClient Project</label><div class=attachments-files><li><a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.6-build-api-consumer/_index.files/TripSearchJavaClient.zip>TripSearchJavaClient.zip</a>
(8 KB)</li><div></section><ol start=10><li>Download the <strong>TripSearchJavaClient.zip</strong> file and extract</li><li>In the Eclipse IDE, open the project we extracted in step 10</li></ol><ul><li>Open the <strong>pom.xml</strong> file</li><li>Replace the <strong>pom.xml</strong> file contents with the following:</li></ul><pre tabindex=0><code>&lt;project xmlns=&#34;http://maven.apache.org/POM/4.0.0&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
  xsi:schemaLocation=&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&#34;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;idevelop.api.tripsearch.sdk.app&lt;/groupId&gt;
  &lt;artifactId&gt;TripSearch-sdkClient&lt;/artifactId&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;name&gt;TripSearch-sdkClient&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;
      &lt;properties&gt;
      &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
      &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
  &lt;/properties&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;3.8.1&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;idevelop.api.sdk&lt;/groupId&gt;
        &lt;artifactId&gt;TripSearch&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        &lt;scope&gt;compile&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.2.4&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;shade&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;transformers&gt;
                &lt;transformer implementation=&#34;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&#34;&gt;
                  &lt;mainClass&gt;idevelop.api.tripsearch.sdk.app.App&lt;/mainClass&gt;
                &lt;/transformer&gt;
              &lt;/transformers&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-010.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API">
12. In the <strong>Command Prompt</strong>, navigate to the directory of the project we extracted in step 10</p><ul><li>Execute the following command</li></ul><pre tabindex=0><code>mvn package
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-011.png?featherlight=false&width=60pc" alt="Build A Client To Consume The API">
13. Execute the following command to run project</p><pre tabindex=0><code>java -jar target/TripSearch-sdkClient-1.0-SNAPSHOT.jar
</code></pre><ul><li>You will see an output.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-012.png?featherlight=false&width=60pc" alt="Build A Client To Consume The API"></li></ul><p>The example API consumer will time how long each call to the API takes, and display the results. It will make a maximum of 100 calls as quickly as it can.</p><p>If we had many of these clients consuming the API rapidly, we could overwhelm the provisioned infrastructure, so we need some way of throttling calls. We can use <strong>Usage Plans</strong> to do this.</p><ol start=14><li>Go to <a href=https://console.aws.amazon.com/apigateway/home><strong>AWS API Gateway console</strong></a></li></ol><ul><li>Type <strong>iDevelop - Trip Search API</strong> to the search bar and press <strong>Enter</strong></li><li>Click <strong>iDevelop - Trip Search API</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-013.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=15><li>Click <strong>Usage Plans</strong></li></ol><ul><li>Click <strong>Create</strong></li><li>In the <strong>Name</strong> section, type <code>LabPlan</code></li><li>In the <strong>Rate</strong> section, type <code>1</code></li><li>In the <strong>Burst</strong> section, type <code>1</code></li><li>In the <strong>Quota</strong> section, type <code>1000</code> per month</li><li>Click <strong>Next</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-014.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=16><li>Click <strong>Add API Stage</strong></li></ol><ul><li>In the <strong>API</strong> drop-down list, select <strong>iDevelop - Trip Search API</strong></li><li>In the <strong>Stage</strong> drop-down list, select <strong>prod</strong></li><li>Click the grey tick icon to commit the changes</li><li>Click <strong>Next</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-015.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=17><li>CLick <strong>Create API Key and add to Usage Plan</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-016.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li><li>In the dialog that appears, for <strong>Name</strong> type <code>SDKClient</code></li></ol><ul><li>Click <strong>Save</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-017.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=19><li>Click <strong>Done</strong>, A new API key will be created and associated with the usage Plan.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-018.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li><li>Click <strong>iDevelop - Trip Search API</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-019.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li><li>Click the <strong>GET</strong> method beneath <strong>/tripsfromcity/{city}</strong></li></ol><ul><li>Click <strong>Method Request</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-020.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=22><li>In the <strong>API Key Required</strong> section, click the pencil edit icon
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-021.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li><li>Select <strong>True</strong></li></ol><ul><li>Click the grey tick icon to commit the change
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-022.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=24><li>Click <strong>Actions</strong></li></ol><ul><li>Click <strong>Deploy API</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-023.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=25><li>In the dialog that appears:</li></ol><ul><li>In the <strong>Deployment stage</strong> section, select <strong>prod</strong></li><li>Click <strong>Deploy</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-024.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=26><li>In the <strong>prod Stage Editor</strong>, click <strong>SDK Generation</strong></li></ol><ul><li>In the <strong>Platform</strong> section, select <strong>Java SDK</strong></li><li>In the <strong>Service name</strong> section, type <code>TripSearch</code></li><li>In the <strong>Java package name</strong> section, type <code>idevelop.api.sdk</code></li><li>Click <strong>Generate SDK</strong>. The Java SDK will be generated and downloaded as a ZIP file.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-025.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=27><li>Extract the ZIP file we downloaded in step 26</li></ol><ul><li>Open <strong>Command Prompt</strong> and navigate to the directory of the downloaded SDK has been exploded (the directory is called <strong>generated-code</strong>)</li><li>Execute the following command</li></ul><pre tabindex=0><code>mvn install
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-026.png?featherlight=false&width=60pc" alt="Build A Client To Consume The API"></p><p>This will compile and install the SDK in your local Maven repository, overwriting the previous version.</p><h4 id=test-the-newly-generated-sdk-with-the-java-client-app>Test the newly generated SDK with the Java client app</h4><ol start=28><li>Execute the following command to run application</li></ol><pre tabindex=0><code>java -jar target/TripSearch-sdkClient-1.0-SNAPSHOT.jar
</code></pre><ul><li>ince you have set the <strong>/tripsfromcity/{GET}</strong> endpoint to require an <strong>API Key</strong>, but have not actually set an API in the client application, you will see a <strong>Forbidden</strong> error
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-027.png?featherlight=false&width=60pc" alt="Build A Client To Consume The API"></li></ul><h4 id=set-the-api-key-in-the-client-code-and-re-run-the-api-consumer-application-with-throttling-enabled>Set the API Key in the client code and re-run the API consumer application with throttling enabled</h4><ol start=29><li>Click <strong>API Keys</strong></li></ol><ul><li>Click <strong>SDKClient</strong></li><li>In the <strong>API Key</strong> section, click <strong>show</strong> to show the <strong>auto-generated API key</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-028.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=30><li>Save the <strong>API key</strong> in the <strong>API key</strong> section
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-029.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li><li>In the Eclipse IDE, open the file whose the path is <strong>/src/main/java/idevelop/api/tripsearch/sdk/app/App.java</strong></li></ol><ul><li>Replace <strong>&lt;REPLACE_WITH_API_KEY></strong> with the <strong>API key</strong> value we saved in step 30</li><li>In the same file, locate the commented out call to <strong>apiKey(API_KEY)</strong> in the TripSearch builder call. You may have to run a Maven Update on the project to pick up the .apiKey as we updated the jar in the last step and Eclipse may not have picked it up. Now that you have required an API Key in the API Gateway call, the SDK created for you will contain a call to allow the key to be set. If you have no API Key requirements, the code generator does not emit this functionality so in the provided code, it is commented out. You need to enable the call in the client code to allow the API Key to be set correctly.</li><li>Save
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-030.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=32><li>In the Eclipse IDE, right-click on the <strong>TripSearch-sdkClient</strong> project</li></ol><ul><li>Click <strong>Maven</strong></li><li>Click <strong>Update Project&mldr;</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-031.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API"></li></ul><ol start=33><li>In the <strong>Command Prompt</strong>, execute the following command</li></ol><pre tabindex=0><code>mvn package
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-032.png?featherlight=false&width=60pc" alt="Build A Client To Consume The API">
34. In the <strong>Command Prompt</strong>, execute the following command</p><pre tabindex=0><code>java -jar target/TripSearch-sdkClient-1.0-SNAPSHOT.jar
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-033.png?featherlight=false&width=60pc" alt="Build A Client To Consume The API">
35. You will now periodically start receiving errors requesting you slow down the call-rate. This is because we set a maximum call-rate of 1 call per second per API key. You will see a output
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-034.png?featherlight=false&width=60pc" alt="Build A Client To Consume The API">
36. As an experiment, edit the API_KEY you have set in the App class (for example, add a period at the end) which will cause it to be invalid. Re-run the app and notice that you now receive a Forbidden message. This is because you set the API Key as required for calls to the /tripsfromcity call.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-035.png?featherlight=false&width=90pc" alt="Build A Client To Consume The API">
37. In the <strong>Command Prompt</strong>, execute the following command</p><pre tabindex=0><code>java -jar target/TripSearch-sdkClient-1.0-SNAPSHOT.jar
</code></pre><ul><li>You will see a output
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.6-build-api-consumer/build-api-consumer-036.png?featherlight=false&width=60pc" alt="Build A Client To Consume The API"></li></ul><ol start=38><li>Experiment with the <strong>Rate</strong> and <strong>Burst</strong> settings in the Usage Plan to see how they affect the client app calling the API<div class="notices note"><p>you do not need to re-deploy the API nor re-create the SDK if you change the settings in the <strong>Usage Plan</strong>.</p></div></li></ol><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.5-setup-single-page-app-website/ title="Setup The Single Page Application Website"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=https://hotloncon1.github.io/aws-lab000055/4-configure-aaa/ title="Configure Authentication, Authorization and Accounting (AAA)" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=https://hotloncon1.github.io/aws-lab000055/js/clipboard.min.js?1659035587></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/perfect-scrollbar.min.js?1659035587></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/perfect-scrollbar.jquery.min.js?1659035587></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/jquery.sticky.js?1659035587></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/featherlight.min.js?1659035587></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/highlight.pack.js?1659035587></script>
<script>hljs.initHighlightingOnLoad()</script><script src=https://hotloncon1.github.io/aws-lab000055/js/modernizr.custom-3.6.0.js?1659035587></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/learn.js?1659035587></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/hugo-learn.js?1659035587></script>
<link href=https://hotloncon1.github.io/aws-lab000055/mermaid/mermaid.css?1659035587 rel=stylesheet><script src=https://hotloncon1.github.io/aws-lab000055/mermaid/mermaid.js?1659035587></script>
<script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>