<!doctype html><html lang=vi class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.101.0"><meta name=description content><meta name=author content="journeyoftheaverageguy@gmail.com"><link rel=icon href=https://hotloncon1.github.io/aws-lab000055/images/favicon.png type=image/png><title>Tạo và Cung cấp API với Amazon API Gateway :: Tạo một Single Page Application(SPA) được xác thực</title><link href=https://hotloncon1.github.io/aws-lab000055/css/nucleus.css?1659048300 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/fontawesome-all.min.css?1659048300 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/hybrid.css?1659048300 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/featherlight.min.css?1659048300 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/perfect-scrollbar.min.css?1659048300 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/auto-complete.css?1659048300 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/atom-one-dark-reasonable.css?1659048300 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/theme.css?1659048300 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/hugo-theme.css?1659048300 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000055/css/theme-workshop.css?1659048300 rel=stylesheet><script src=https://hotloncon1.github.io/aws-lab000055/js/jquery-3.3.1.min.js?1659048300></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.3-create-api-with-api-gateway/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://hotloncon1.github.io/aws-lab000055/><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=https://hotloncon1.github.io/aws-lab000055/js/lunr.min.js?1659048300></script>
<script type=text/javascript src=https://hotloncon1.github.io/aws-lab000055/js/auto-complete.js?1659048300></script>
<script type=text/javascript>var baseurl="https://hotloncon1.github.io/aws-lab000055//vi"</script><script type=text/javascript src=https://hotloncon1.github.io/aws-lab000055/js/search.js?1659048300></script></div><div class=highlightable><ul class=topics><li data-nav-id=/vi/1-introduction/ title="Giới thiệu" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/1-introduction/><b>1. </b>Giới thiệu
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/2-prepare/ title="Chuẩn bị" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/2-prepare/><b>2. </b>Chuẩn bị
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/2-prepare/2.1-createkeypair/ title="Tạo Key Pair" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/2-prepare/2.1-createkeypair/><b>2.1. </b>Tạo Key Pair
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/2-prepare/2.2-createstack/ title="Tạo CloudFormation stack" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/2-prepare/2.2-createstack/><b>2.2. </b>Tạo CloudFormation stack
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/2-prepare/2.3-connectvirtualmachine/ title="Kết nối Windows instance" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/2-prepare/2.3-connectvirtualmachine/><b>2.3. </b>Kết nối Windows instance
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/3-create-single-page-app/ title="Tạo Single Page Application" class="dd-item
parent"><a href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/><b>3. </b>Tạo Single Page Application
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/3-create-single-page-app/3.1-create-dynamodb-table/ title="Tạo DynamoDB Table" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.1-create-dynamodb-table/><b>3.1. </b>Tạo DynamoDB Table
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-create-single-page-app/3.2-build-and-deploy-serverless-microservice/ title="Xây dựng và triển khai Serverless Microservice thủ công" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.2-build-and-deploy-serverless-microservice/><b>3.2. </b>Xây dựng và triển khai Serverless Microservice thủ công
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-create-single-page-app/3.3-create-api-with-api-gateway/ title="Tạo và Cung cấp API với Amazon API Gateway" class="dd-item
active"><a href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.3-create-api-with-api-gateway/><b>3.3. </b>Tạo và Cung cấp API với Amazon API Gateway
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-create-single-page-app/3.4-deploy-api-with-codestar/ title="Triển khai API với Codestar và CI/CD" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.4-deploy-api-with-codestar/><b>3.4. </b>Triển khai API với Codestar và CI/CD
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-create-single-page-app/3.5-setup-single-page-app-website/ title="Thiết lập trang SPA " class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.5-setup-single-page-app-website/><b>3.5. </b>Thiết lập trang SPA
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-create-single-page-app/3.6-build-api-consumer/ title="Tạo một Client để sử dụng API" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.6-build-api-consumer/><b>3.6. </b>Tạo một Client để sử dụng API
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/4-configure-aaa/ title="Cấu hình Authentication, Authorization và Accounting (AAA)" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/4-configure-aaa/><b>4. </b>Cấu hình Authentication, Authorization và Accounting (AAA)
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/4-configure-aaa/4.1-add-authentication-with-cognito/ title="Thêm Xác thực vào SPA sử dụng Amazon Cognito User Pools" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/4-configure-aaa/4.1-add-authentication-with-cognito/><b>4.1. </b>Thêm Xác thực vào SPA sử dụng Amazon Cognito User Pools
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-configure-aaa/4.2-setup-authentication/ title="Thiết lập Xác thực cho Microservice" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/4-configure-aaa/4.2-setup-authentication/><b>4.2. </b>Thiết lập Xác thực cho Microservice
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-configure-aaa/4.3-deploy-and-test/ title="Triển khai và Kiểm thử" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/4-configure-aaa/4.3-deploy-and-test/><b>4.3. </b>Triển khai và Kiểm thử
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-configure-aaa/4.4-add-new-user-signup_signin/ title="Đăng ký người dùng mới và đăng nhập" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/4-configure-aaa/4.4-add-new-user-signup_signin/><b>4.4. </b>Đăng ký người dùng mới và đăng nhập
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-tracing-application-performance-with-xray/ title="Theo dõi Hiệu năng Ứng dụng với AWS X-Ray" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/5-tracing-application-performance-with-xray/><b>5. </b>Theo dõi Hiệu năng Ứng dụng với AWS X-Ray
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/6-challenge/ title="Bài tập nâng cao " class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/6-challenge/><b>6. </b>Bài tập nâng cao
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/7-cleanup/ title="Dọn dẹp tài nguyên" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000055/vi/7-cleanup/><b>7. </b>Dọn dẹp tài nguyên
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/660548818043427/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.3-create-api-with-api-gateway/>English</option><option id=vi value=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.3-create-api-with-api-gateway/ selected>Tiếng Việt</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7833031&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0></left>
<left><br><br><b>Last Updated</b><br><i><font color=orange>29-07-2022</font></i></left>
<left><br><br><b>Team</b><br><i><a href=https://www.linkedin.com/in/jotaguy style=color:orange>Gia Hưng</a></i></left>
<script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=https://hotloncon1.github.io/aws-lab000055/vi/>Tạo một Ứng dụng Đơn trang (SPA) được xác thực</a> > <a href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/>Tạo Single Page Application</a> > Tạo và Cung cấp API với Amazon API Gateway</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Tạo và Cung cấp API với Amazon API Gateway</h1><h4 id=tạo-và-cung-cấp-api-với-amazon-api-gateway>Tạo và Cung cấp API với Amazon API Gateway</h4><ol><li>Truy cập <a href=https://console.aws.amazon.com/apigateway/home><strong>AWS API Gateway console</strong></a>.</li></ol><ul><li>Trong phần <strong>Choose an API type</strong>, tìm <strong>REST API - Develop a REST API where you gain complete control over the request and response along with API management capabilities.</strong></li><li>Click <strong>Build</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-001.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=2><li>Click <strong>OK</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-002.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Trong phần <strong>Create new API</strong>, chọn <strong>New API</strong></li></ol><ul><li>Tại mục <strong>API name</strong>, điền <code>iDevelop - Trip Search API</code></li><li>Tại mục <strong>Description</strong>, điền <code>Allows searching ở trips from/to cities</code></li><li>Click <strong>Create API</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-003.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=4><li>API sẽ được tạo và chỉ có đường dẫn <strong>root</strong>.</li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-004.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=5><li>Trong trang <strong>New Child Resource</strong></li></ol><ul><li>Tại mục <strong>Resource Name</strong>, điền <code>trips</code></li><li>Đánh dấu vào <strong>Enable API Gateway CORS</strong></li><li>Click <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-005.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=6><li>Resource <strong>/trips</strong> sẽ được tạo. Chọn vào đường dẫn <strong>/trips</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Create Method</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-006.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=7><li>Trong danh sách liệt kê xuất hiện, chọn <strong>GET</strong></li></ol><ul><li>Chọn dấu tick nâu bên cạnh để xác nhận lưu thiết lập.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-007.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=8><li>Tại mục <strong>Lambda Region</strong>, chọn <strong>Region</strong> của bạn</li></ol><ul><li>Tại mục <strong>Lambda Function</strong>, nhập <code>idevelop</code> và chọn <strong>idevelopTripSearchFull</strong></li><li>Click <strong>Save</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-008.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=9><li>Click <strong>OK</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-009.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Khi method được tạo, bạn sẽ thấy bảng <strong>Method Execution</strong>:
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-010.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>Test</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-011.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>Test</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-012.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Sau một vài phút để hàm Lambda khởi chạy và thực thi, bạn sẽ thấy kết quả tương tự như sau:
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-013.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>/trips</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Enable CORS</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-014.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=15><li>Click <strong>Enable CORS and replace existing CORS headers</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-015.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>Yes, replace existing values</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-016.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Khi các mục liệt kê có dấu tích xanh, bạn có thể tiếp tục các bước kế. Sẽ mất một ít thời gian để hoàn thành.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-017.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ol><h4 id=cung-cấp-tripsfromcity-restful-api-endpoint>Cung cấp <strong>/tripsfromcity</strong> RESTful API endpoint</h4><p>Đường dẫn đầu tiên mà chúng ta cung cấp khá đơn giản - /trips sẽ lấy tất cả các chuyến đi trong hệ thống.</p><p>Nhưng chúng ta biết việc triển khai mã nguồn của chúng ta cho phép chúng ta chỉ định một bộ lọc để truy vấn ở các chuyến đi xuất phát từ một thành phố cụ thể hoặc có điểm đến cụ thể. Vì vậy chúng ta muốn hiển thị chức năng này cho người dùng API của mình. Đầu tiên, chúng ta sẽ hiển thị đường dẫn <strong>/tripfromcity</strong>.</p><ol start=18><li>Trong phần <strong>Resources</strong>, click <strong>/</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-018.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=19><li>Tại mục <strong>Resource Name</strong>, điền <code>tripsfromcity</code></li></ol><ul><li>Chọn <strong>Enable API Gateway CORS</strong></li><li>CLick <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-019.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=20><li>Lệnh gọi của chúng ta vào hàm Lambda yêu cầu thông số <strong>city</strong>. Chúng ta sẽ đi theo tiêu chuẩn ở RESTful interface và chuyển tham số này vào dưới dạng tham số truyền trên URL. Chọn <strong>/tripsfromcity</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-020.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=21><li>Tại mục <strong>Resource Name</strong>, điền <code>{city}</code></li></ol><ul><li>Tại mục <strong>Resource Path</strong>, xóa nội dung mặc định và điền <code>{city}</code></li><li>Click <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-021.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=22><li>Click <strong>/{city}</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Create Method</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-022.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=23><li>Trong danh sách liệt kê, chọn <strong>GET</strong></li></ol><ul><li>Click tick xám bên cạnh để xác nhận lưu thiết lập.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-023.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=24><li>Tại mục <strong>Lambda Region</strong>. chọn <strong>Region</strong> của bạn</li></ol><ul><li>Tại mục <strong>Lambda Function</strong>, nhập <code>idevelop</code> và chọn <strong>idevelopTripSearchFromCity</strong></li><li>Click <strong>Save</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-024.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=25><li>Click <strong>OK</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-025.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Khi method được tạo, bạn sẽ thấy bảng <strong>Method Execution</strong>. Chúng ta không thể tiếp tục thực hiện kiểm thử gọi đến API bởi vì chúng ta cần biến đổi yêu cầu thông qua API Gateway nhằm lấy được thông tin {city} được truyền qua hàm Lambda chính xác.</li></ol><p><strong>devlounge.lambda.FindTripsFromCityHandler</strong> handler cần thấy được thông số truyền vào từ yêu cầu như sau:</p><pre tabindex=0><code>{
	&#34;payload&#34; : 
	{
        &#34;city&#34;: &#34;Melbourne&#34;
    }
}
</code></pre><div class="notices note"><p>Điều này sẽ khiến hàm Lambda tìm kiếm DynamoDB ở tất cả các chuyến đi xuất phát từ Melbourne. Chúng ta cần thêm một Body Mapping Template cho method này ở API Gateway nhằm chuyển đổi thông số cho đúng theo yêu cầu.</p></div><ul><li>Click <strong>Integration Request</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-026.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=27><li>Click <strong>Mapping Templates</strong></li></ol><ul><li>Click <strong>When there are no templates defined (recommended)</strong></li><li>Click <strong>Add mapping template</strong></li><li>Trong mục <strong>Content-Type</strong>, nhập <code>application/json</code></li><li>Click dấu tick xám để lưu lựa chọn.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-027.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=28><li>Bên dưới mục <strong>Generate template</strong>, nhập</li></ol><pre tabindex=0><code>{
    &#34;payload&#34; : {
        &#34;city&#34;: &#34;$input.params(&#39;city&#39;)&#34;
    }
}
</code></pre><div class="notices info"><p>Template này sẽ lấy tham số <strong>{city}</strong> từ URL và thêm nó vào JSON payload và gửi đến hàm Lambda giống như hàm Lambda mong đợi.</p></div><ul><li>Click <strong>Save</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-028.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><div class="notices note"><p>Schema được định nghĩa ở đây cho hàm Lambda này là hoàn toàn có thể tùy chỉnh và trong ứng dụng của bạn, bạn có thể sử dụng một mô hình hoàn toàn khác. Mẫu ánh xạ cung cấp cho bạn sự linh hoạt để chuyển đổi dữ liệu đến một cách nhanh chóng thông qua API Gateway endpoint.</p></div><ol start=29><li>Click <strong>Method Execution</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-029.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>Test</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-030.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Trong mục <strong>Path</strong>, tại trường <strong>{city}</strong>, nhập <code>Melbourne</code></li></ol><ul><li>Click <strong>Test</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-031.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=32><li>API Gateway sẽ thực hiện lệnh gọi vào hàm Lambda, truyền giá trị Melbourne vào Body Mapping Template mà bạn đã xác định, chèn tham số tìm kiếm Melbourne vào JSON payload được gửi đến hàm Lambda. Điều này sẽ khiến handler sử dụng JSON và thực hiện tìm kiếm trong bảng DynamoDB và trả về kết quả. Bạn sẽ thấy một kết quả tương tự như sau:
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-032.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Chọn <strong>/{city}</strong> trong phần <strong>/tripsfromcity</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Enable CORS</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-033.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=34><li>Click <strong>Enable CORS and replace existing CORS headers</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-034.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>Yes, replace existing values</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-035.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Khi các mục liệt kê có dấu tick xanh, bạn có thể tiếp tục các bước kế. Sẽ mất một ít thời gian để hoàn thành.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-036.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>/</strong> trong phần <strong>Resources</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-037.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=38><li>Tại mục <strong>Resource Name</strong>, nhập <code>tripstocity</code></li></ol><ul><li>Chọn <strong>Enable API Gateway CORS</strong></li><li>Click <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-038.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=39><li>Lệnh gọi của chúng ta vào hàm Lambda yêu cầu thông số <strong>city</strong>. Chúng ta sẽ đi theo tiêu chuẩn ở RESTful interface và chuyển tham số này vào dưới dạng tham số truyền trên URL. Click <strong>/tripstocity</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-039.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=40><li>Tại mục <strong>Resource Name</strong>, nhập <code>{city}</code></li></ol><ul><li>Tại mục <strong>Resource Path</strong>, xóa nội dung mặc định và nhập <code>{city}</code></li><li>Chọn <strong>Enable API Gateway CORS</strong></li><li>Click <strong>Create Resource</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-040.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=41><li>CLick <strong>/{city}</strong> trong phần <strong>/tripstocity</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Create Method</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-041.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=42><li>Trong danh sách liệt kê, chọn <strong>GET</strong></li></ol><ul><li>Click dấu tick xám bên cạnh để xác nhận lưu thiết lập.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-042.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=43><li>Trong mục <strong>Lambda Region</strong>, chọn <strong>Region</strong> của bạn</li></ol><ul><li>Tại mục <strong>Lambda Function</strong>, nhập <code>idevelop</code> và chọn <strong>idevelopTripSearchToCity</strong></li><li>Click <strong>Save</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-043.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=44><li>Click <strong>OK</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-044.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Khi method được tạo, bạn sẽ thấy bảng <strong>Method Execution</strong>. Chúng ta không thể tiếp tục thực hiện kiểm thử gọi đến API bởi vì chúng ta cần biến đổi yêu cầu thông qua API Gateway nhằm lấy được thông tin {city} được truyền qua hàm Lambda chính xác.</li></ol><p><strong>devlounge.lambda.FindTripsToCityHandler</strong> handler cần thấy được thông số truyền vào từ yêu cầu như sau:</p><pre tabindex=0><code>{
	&#34;payload&#34; : 
	{
        &#34;city&#34;: &#34;Melbourne&#34;
    }
}
</code></pre><div class="notices note"><p>Điều này sẽ khiến hàm Lambda tìm kiếm DynamoDB ở tất cả các chuyến đi đến Melbourne. Chúng ta cần thêm một Body Mapping Template cho method này ở API Gateway nhằm chuyển đổi thông số cho đúng theo yêu cầu.</p></div><ul><li>Click <strong>Integration Request</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-045.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=46><li>Click <strong>Mapping Templates</strong></li></ol><ul><li>Chọn <strong>When there are no templates defined (recommended)</strong></li><li>Click <strong>Add mapping template</strong></li><li>Tại mục <strong>Content-Type</strong>, nhập <code>application/json</code></li><li>Click dấu tick xám để lưu lựa chọn.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-046.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=47><li>Bên dưới mục <strong>Generate template</strong>, nhập</li></ol><pre tabindex=0><code>{
    &#34;payload&#34; : {
        &#34;city&#34;: &#34;$input.params(&#39;city&#39;)&#34;
    }
}
</code></pre><ul><li>Click <strong>Save</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-047.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=49><li>Click <strong>Method Execution</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-048.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>Test</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-049.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Trong mục <strong>Path</strong>, tại trường <strong>{city}</strong>, nhập <code>Melbourne</code></li></ol><ul><li>Click <strong>Test</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-050.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=52><li>API Gateway sẽ thực hiện lệnh gọi vào hàm Lambda, truyền giá trị Melbourne vào Body Mapping Template mà bạn đã xác định, chèn tham số tìm kiếm Melbourne vào JSON payload được gửi đến hàm Lambda. Điều này sẽ khiến handler sử dụng JSON và thực hiện tìm kiếm trong bảng DynamoDB và trả về kết quả. Bạn sẽ thấy một kết quả tương tự như sau:
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-051.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>/{city}</strong> trong phần <strong>/tripstocity</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Enable CORS</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-052.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=54><li>CLick <strong>Enable CORS and replace existing CORS headers</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-053.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Click <strong>Yes, replace existing values</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-054.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Khi các mục liệt kê có dấu tick xanh, bạn có thể tiếp tục các bước kế. Sẽ mất một ít thời gian để hoàn thành.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-055.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Nếu đã hoàn thành đến đây, bạn sẽ có một cây Resource nhìn tương tự như thế này:
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-056.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ol><h4 id=triển-khai-api-và-kiểm-thử>Triển khai API và Kiểm thử</h4><ol start=58><li>Trong phần <strong>Resources</strong>, click <strong>/</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>CLick <strong>Deploy API</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-057.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=59><li>Tại mục <strong>Deployment stage</strong>, chọn <strong>[New Stage]</strong></li></ol><ul><li>Tại mục <strong>Stage name</strong>, nhập <code>prod</code></li><li>Tại mục <strong>Stage description</strong>, nhập <code>Trips API</code></li><li>Tại mục <strong>Deployment description</strong>, nhập <code>Initial deployment</code></li><li>Click <strong>Deploy</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-058.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=60><li>Stage mới tên <strong>prod</strong> sẽ được tạo và bạn sẽ thấy <strong>prod Stage Editor</strong></li></ol><ul><li>Click <strong>Invoke URL</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-059.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=61><li>Một cửa sổ mới sẽ mở ra và truy cập đến địa chỉ đó. Bạn sẽ thấy một thông báo lỗi nêu rõ <strong>{&ldquo;message&rdquo;:&ldquo;Missing Authentication Token&rdquo;}</strong>. Điều này là do không có trình xử lý ở đường dẫn gốc của stage - bạn chỉ có các resources/methods được xác định bên dưới các đường dẫn <strong>/trips</strong>, <strong>/tripsfromcity</strong> và <strong>/tripstocity</strong>.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-060.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Chỉnh sửa URL trong thanh URL của trình duyệt và thêm <strong>/trips</strong> rồi nhấn Enter. Trang sẽ làm mới và sau đó hiển thị tất cả các chuyến đi có sẵn dưới dạng JSON. Đầu ra sẽ tương tự như sau:
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-061.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Kiểm tra method <strong>/tripsfromcity</strong>, sử dụng <code>/tripsfromcity/Melbourne</code> để tìm kiếm tất cả các chuyến đi khởi hành từ Melbourne.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-062.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Kiểm tra method <strong>/tripstocity</strong>, sử dụng <code>/tripstocity/Melbourne</code> để tìm kiếm tất cả các chuyến đi đến Melbourne.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-063.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ol><p>Nếu dữ liệu có vẻ đúng và không có lỗi, bạn đã sẵn sàng chuyển sang phần tiếp theo.</p><h4 id=sử-dụng-cloudformationsam-thông-qua-aws-cli-để-triển-khai-microservice-hotelsearch>Sử dụng CloudFormation/SAM thông qua AWS CLI để triển khai microservice HotelSearch</h4><p>Trong các bước trước đó, bạn đã triển khai và cấu hình microservice <strong>TripSearch</strong> theo cách thủ công, bao gồm các hàm Lambda và API Gateway resource. Bạn sẽ nhận thấy rằng có khá nhiều bước cần làm và thực hiện việc này theo cách thủ công rất tốn thời gian và dễ xảy ra lỗi. Trong bước này, bạn sẽ sử dụng AWS CLI và CloudFormation/SAM để triển khai microservice <strong>HotelSearch</strong>, thay vì triển khai thủ công các tài nguyên.</p><p>Bằng cách sử dụng CloudFormation/SAM, nhiều bước thủ công sẽ được thực hiện cho bạn, sắp xếp quy trình triển khai. Bạn vẫn sẽ phải kích hoạt quy trình theo cách thủ công, nhưng việc triển khai thực tế sẽ được tự động hóa.</p><p><strong>HotelSpecials</strong> microservice cần truy cập vào cơ sở dữ liệu MySQL để truy xuất dữ liệu về các dữ liệu đặc biệt của khách sạn. Môi trường bài thực hành đã tự động triển khai và tạo cơ sở dữ liệu cho bạn và chi tiết kết nối được cung cấp trong CloudFormation Outputs với hướng dẫn bên dưới về nơi cập nhật các thông số trong template mà bạn sẽ sử dụng để triển khai microservice. Cơ sở dữ liệu MySQL đã được triển khai bằng Amazon RDS và không thể truy cập công khai vì nó được khởi chạy trong một mạng con riêng tư. Do đó, để hàm Lambda để có thể kết nối với cơ sở dữ liệu, hàm Lambda cũng sẽ cần được triển khai thành một mạng con riêng bằng cách kích hoạt VPC Integration. Tập tin template.yml được cung cấp có tất cả các thiết lập cần thiết để thực hiện việc này, bạn chỉ cần cập nhật các thông số theo hướng dẫn bên dưới.</p><section class="attachments orange"><label><i class="fas fa-paperclip" aria-hidden=true></i>
HotelSpecials Project</label><div class=attachments-files><li><a href=https://hotloncon1.github.io/aws-lab000055/3-create-single-page-app/3.3-create-api-with-api-gateway/_index.vi.files/HotelSpecials.zip>HotelSpecials.zip</a>
(33 KB)</li><div></section><ol start=65><li>Tải file <strong>HotelSpecials.zip</strong> và giải nén</li><li>Mở <strong>Command Prompt</strong> và chuyển đường dẫn đến project <strong>HotelSpecials</strong> đã giải nén ở bước 65</li></ol><ul><li>Chạy câu lệnh dưới đây:</li></ul><pre tabindex=0><code>set AWS_PROFILE=devaxacademy
mvn package shade:shade
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-064.png?featherlight=false&width=60pc" alt="Create And Expose the API with Amazon API Gateway">
67. Sau khi tập tin JAR đã được build sẽ nằm trong thư mục <strong>target</strong> của project và có tên là <strong>hotelspecials-1.0.0.jar</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-065.png?featherlight=false&width=60pc" alt="Create And Expose the API with Amazon API Gateway">
68. Truy cập <a href=https://console.aws.amazon.com/cloudformation/>AWS CloudFormation Console</a>.</p><ul><li>Click <strong>Stack</strong>.</li><li>Nhập <code>DevAx-06</code> vào ô tìm kiếm và nhấn <strong>Enter</strong>.</li><li>Click <strong>DevAx-06</strong>.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-066.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=69><li>Click tab <strong>Output</strong></li></ol><ul><li>Lưu lại giá trị <strong>DatabaseSecurityGroup</strong>, <strong>DatabaseSubnet1</strong>, <strong>DatabaseSubnet2</strong>, <strong>RDSEndpoint</strong> và <strong>S3BucketLambdaCodeBucketName</strong> để sử dụng trong bước tiếp theo.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-067.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=70><li>Trong Eclipse IDE, mở file <strong>template.yml</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-068.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li><li>Thay <strong>&lt;DatabaseSecurityGroup></strong> bằng giá trị <strong>DatabaseSecurityGroup</strong> đã lưu trong bước 69</li></ol><ul><li>Thay <strong>&lt;DatabaseSubnet1></strong> bằng giá trị <strong>DatabaseSubnet1</strong> đã lưu trong bước 69</li><li>Thay <strong>&lt;DatabaseSubnet2></strong> bằng giá trị <strong>DatabaseSubnet2</strong> đã lưu trong bước 69</li><li>Thay <strong>&lt;RDSEndpoint></strong> bằng giá trị <strong>RDSEndpoint</strong> đã lưu trong bước 69</li><li>Lưu lại
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-069.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=72><li>Trong <strong>Command Prompt</strong>, chạy câu lệnh dưới đây để để đóng gói hàm Lambda (từ thành phần triển khai bạn đã tạo)</li></ol><pre tabindex=0><code>aws cloudformation package --template template.yml --s3-bucket &lt;S3BucketLambdaCodeBucketName&gt; --output-template template-export.yml
</code></pre><p><div class="notices note"><p>Thay <strong>&lt;S3BucketLambdaCodeBucketName></strong> bằng giá trị <strong>S3BucketLambdaCodeBucketName</strong> đã lưu trong bước 69</p></div><img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-070.png?featherlight=false&width=60pc" alt="Create And Expose the API with Amazon API Gateway"><div class="notices info"><p>Lệnh sẽ tải lên các artifact vào S3 bucket, sau đó cập nhật con trỏ <strong>template.yml</strong> thành artifact trên S3 và ghi ra một mẫu mới có kèm theo bản cập nhật này vào một tệp có tên <strong>template-export.yml</strong>.<br>Sẽ mất một hoặc hai phút để hoàn tất quá trình tải lên artifact.</p></div>73. Chạy lệnh dưới đây để tạo và triển khai <strong>CloudFormation Change Set</strong></p><pre tabindex=0><code>aws cloudformation deploy --template-file template-export.yml --stack-name HotelSpecialsAPI --capabilities CAPABILITY_IAM
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-071.png?featherlight=false&width=60pc" alt="Create And Expose the API with Amazon API Gateway">
74. Truy cập <a href=https://console.aws.amazon.com/cloudformation/>AWS CloudFormation Console</a>.</p><ul><li>Click <strong>Stack</strong>.</li><li>Bạn sẽ thấy stack có tên <strong>HotelSpecialsAPI</strong>. Điều này cho thấy rằng <strong>CloudFormation Change Set</strong> đã được tạo. Lệnh bạn đã đưa ra sẽ tạo Change Set và sau đó tự động thực hiện Change Set. Sẽ mất một vài phút để hoàn tất quá trình thực thi.
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-072.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=75><li>Chọn <strong>HotelSpecialsAPI</strong> stack, click tab <strong>Events</strong> và xem lại các bước mà CloudFormation template đã áp dụng cho môi trường của bạn. Chúng sẽ khớp với các tài nguyên và hành động trong tập tin <strong>template-output.yml</strong>.</li><li>Truy cập <a href=https://console.aws.amazon.com/apigateway/home><strong>AWS API Gateway console</strong></a></li></ol><ul><li>Click <strong>iDevelop - Hotel Specials API</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-073.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=77><li>Click <strong>Get</strong></li></ol><ul><li>Click <strong>Integration Request</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-074.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=78><li>Bảng <strong>Integration Request</strong> sẽ xuất hiện. <strong>Lambda Function</strong> xác định:
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-075.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ol><p>Giá trị được chỉ định không phải là một hàm Lambda, mà thay vào đó, là một <strong>Stage Variable</strong> sẽ được thay thế trong thời gian chạy bằng API Gateway. Do đó, để lệnh gọi API này thành công, <strong>Stage</strong> trong API Gateway phải xác định một giá trị cho Stage Variable <strong>envHotelSpecials</strong></p><ol start=79><li>Click <strong>Stages</strong></li></ol><ul><li>Click <strong>prod</strong></li><li>Click tab <strong>Stage Variables</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-076.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"><div class="notices info"><p>Một biến duy nhất được xác định - <strong>envHotelSpecials</strong> - giống với tên biến giai đoạn mà phương thức GET đã mong đợi. Giá trị của biến là <strong>GetHotelSpecials</strong> là tên của hàm Lambda mà mẫu được tạo bằng cách sử dụng tập tin JAR mà bạn đã tạo và tải lên trong quá trình đóng gói/triển khai.</p></div></li></ul><h4 id=kiểm-thử-hotelspecials-api>Kiểm thử HotelSpecials API</h4><ol start=80><li>Mở rộng <strong>prod</strong> trong <strong>Stages</strong> để xem cấu trúc.</li></ol><ul><li>Click <strong>Get</strong></li><li>Click <strong>Invoke URL</strong>
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-077.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ul><ol start=81><li>Sau một khoảng thời gian, hàm Lambda khởi tạo, bạn sẽ thấy kết quả JSON truy xuất dữ liệu từ cơ sở dữ liệu MySQL về từ hàm Lambda
<img src="https://hotloncon1.github.io/aws-lab000055/images/3-create-single-page-app/3.3-create-api-with-api-gateway/create-api-with-api-gateway-078.png?featherlight=false&width=90pc" alt="Create And Expose the API with Amazon API Gateway"></li></ol><p>Nếu bạn thấy một kết quả JSON không có lỗi, bạn đã triển khai thành công một API và hỗ trợ hàm Lambda truy vấn cơ sở dữ liệu mySQL.</p><p>Chú ý rằng chúng nhanh hơn và dễ hơn việc triển khai thủ công như thế nào?</p><p>Đó là sức mạnh của tự động hóa. Trong bài tập tiếp theo, chúng ta sẽ thực hiện bước này xa hơn, sử dụng phương pháp tiếp cận CI/CD pipeline (hiện đã phổ biến) để triển khai API tiếp theo của chúng ta.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.2-build-and-deploy-serverless-microservice/ title="Xây dựng và triển khai Serverless Microservice thủ công"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=https://hotloncon1.github.io/aws-lab000055/vi/3-create-single-page-app/3.4-deploy-api-with-codestar/ title="Triển khai API với Codestar và CI/CD" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=https://hotloncon1.github.io/aws-lab000055/js/clipboard.min.js?1659048300></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/perfect-scrollbar.min.js?1659048300></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/perfect-scrollbar.jquery.min.js?1659048300></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/jquery.sticky.js?1659048300></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/featherlight.min.js?1659048300></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/highlight.pack.js?1659048300></script>
<script>hljs.initHighlightingOnLoad()</script><script src=https://hotloncon1.github.io/aws-lab000055/js/modernizr.custom-3.6.0.js?1659048300></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/learn.js?1659048300></script>
<script src=https://hotloncon1.github.io/aws-lab000055/js/hugo-learn.js?1659048300></script>
<link href=https://hotloncon1.github.io/aws-lab000055/mermaid/mermaid.css?1659048300 rel=stylesheet><script src=https://hotloncon1.github.io/aws-lab000055/mermaid/mermaid.js?1659048300></script>
<script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>